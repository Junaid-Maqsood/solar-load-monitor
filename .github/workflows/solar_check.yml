name: Solar Load Checker

on:
  workflow_dispatch:                # allows manual run
  schedule:
    - cron: '*/5 * * * *'           # every 5 minutes UTC

jobs:
  run-check:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Install dependencies
        run: pip install requests

      - name: Run script only if between 04:00â€“19:00 PKT
        run: |
          echo "Current UTC hour: $(date -u +'%H')"
          PAK_HOUR=$(TZ=Asia/Karachi date +'%H')
          echo "Current Pakistan time hour: $PAK_HOUR"

          if [ "$PAK_HOUR" -ge 4 ] && [ "$PAK_HOUR" -lt 19 ]; then
            echo "âœ… In allowed hours, running script..."
            python push_alert.py
          else
            echo "ðŸŒ™ Outside allowed hours, skipping."
          fi
